@model EquipmentStore.Web.Models.CompositeViewModel

@{
	ViewBag.Title = "Оборудование и услуги";
	Layout = "~/Views/Shared/_Layout.cshtml";
}

<h2>Оборудование</h2>

@if (Model.Machines.Count != 0)
{
	<table class="table table-striped table-bordered">
		<tr>
			<th style="width:10%;">ID</th>
			<th style="width:20%;">Название</th>
			<th style="width:30%;">Фото</th>
			<th style="width:40%;">Действия</th>
		</tr>

		@foreach (var machine in Model.Machines)
		{
			string imageSource = null;

			if (machine.ImageData != null)
			{
				var base64 = Convert.ToBase64String(machine.ImageData.Data);
				imageSource = $"data:{machine.ImageData.MimeType};base64,{base64}";
			}

			<tr>
				<td>@machine.Id</td>
				<td>@machine.Name</td>
				<td><img src="@imageSource" style="width: 320px; height: 240px;" alt="@machine.Name" /></td>
				<td>
					<p>
						@Html.ActionLink("Изменить", "Update", "Machine", new { id = machine.Id }, new { @class = "btn btn-primary" })
					</p>

					<p>
						@using (Html.BeginForm("Delete", "Machine", new { id = machine.Id }))
						{
							<input type="submit" class="btn btn-danger" value="Удалить" />
						}
					</p>
				</td>
			</tr>

			<hr />
		}
	</table>
}

<p>
	@Html.ActionLink("Добавить оборудование", "Create", "Machine", null, new { @class = "btn btn-primary" })
</p>

<h2>Услуги</h2>

@if (Model.Labours.Count != 0)
{
	<table class="table table-striped table-bordered">
		<tr>
			<th style="width:10%;">ID</th>
			<th style="width:20%;">Название</th>
			<th style="width:30%;">Описание</th>
			<th style="width:40%;">Действия</th>
		</tr>

		@foreach (var labour in Model.Labours)
		{
			string imageSource = null;

			if (labour.ImageData != null)
			{
				var base64 = Convert.ToBase64String(labour.ImageData.Data);
				imageSource = $"data:{labour.ImageData.MimeType};base64,{base64}";
			}

			<tr>
				<td>@labour.Id</td>
				<td>@labour.Name</td>
				<td><img src="@imageSource" style="width: 320px; height: 240px;" alt="@labour.Name" /></td>
				<td>
					<p>
						@Html.ActionLink("Изменить", "Update", "Labour", new { id = labour.Id }, new { @class = "btn btn-primary" })
					</p>

					<p>
						@using (Html.BeginForm("Delete", "Labour", new { id = labour.Id }))
						{
							<input type="submit" class="btn btn-danger" value="Удалить" />
						}
					</p>
				</td>
			</tr>

			<hr />
		}
	</table>
}

<p>
	@Html.ActionLink("Добавить услугу", "Create", "Labour", null, new { @class = "btn btn-primary" })
</p>